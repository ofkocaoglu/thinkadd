<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LPBF Material Universe</title>
  <!-- Google Fonts: Open Sans & Poppins -->
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600;700&family=Poppins:wght@700&display=swap" rel="stylesheet">
  <!-- TailwindCSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js"></script>
  <!-- Chart.js DataLabels Plugin -->
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <!-- Global Font Style -->
  <style>
    /* Base text uses Open Sans */
    html, body, p, ul, li {
      font-family: 'Open Sans', sans-serif;
    }
    /* Headings use Poppins Bold */
    h1, h2 {
      font-family: 'Poppins', sans-serif;
      font-weight: 700;
    }
    /* Contact button uses Poppins Bold */
    .contact-button {
      font-family: 'Poppins', sans-serif;
      font-weight: 700;
    }
  </style>
</head>
<body class="bg-gray-50">
  <div class="container mx-auto p-4 relative">
    <!-- Contact Button -->
    <div class="absolute top-4 right-4">
      <a href="mailto:omerfkocaoglu@gmail.com" class="contact-button bg-[#808080] text-white text-base py-2 px-4 rounded transform scale-90 transition hover:bg-[#404040]">Contact Author</a>
    </div>
    <h1 class="text-3xl text-center mb-8">LPBF Material Universe</h1>
    <!-- Chart + Center Image Container -->
    <div class="relative max-w-md mx-auto">
      <canvas id="materialChart" class="relative z-10"></canvas>
      <img src="lpbf.svg" alt="LPBF Logo" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-24 h-24 pointer-events-none z-0" />
    </div>
    <!-- Legend / Lists -->
    <div id="materialLists" class="mt-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6"></div>
    <!-- Disclaimer & Author -->
    <div class="mt-12 text-xs text-gray-600 space-y-2">
      <p class="font-semibold">Disclaimer:</p>
      <p>The material list above has been compiled from publicly available sources and manufacturer datasheets as of the date of publication. It includes both commercially released and research-stage powders claimed to be compatible with Laser Powder Bed Fusion (LPBF) technology. This information is provided “as is” and without any representation or warranty—express or implied—regarding its accuracy, completeness, or fitness for any particular purpose.</p>
      <p class="font-semibold">Prepared by: <a href="https://www.linkedin.com/in/omerfkocaoglu/" class="text-blue-600 hover:underline" target="_blank">Ömer Faruk Kocaoglu</a> | Contact: <a href="mailto:omerfkocaoglu@gmail.com" class="text-blue-600 hover:underline">omerfkocaoglu@gmail.com</a></p>
    </div>
  </div>

  <script>
    // Load material data from external JSON file
    fetch('materialData.json')
      .then(response => response.json())
      .then(materialData => {
        const categories = Object.keys(materialData);
        const dataValues = categories.map(() => 1);
        // Color palette
        const colors = ['#e63946','#f4a261','#e9c46a','#a8dadc','#2a9d8f','#b87333','#1d3557','#6a4c93','#9d4edd','#8ac926'];
        const abbreviations = {
          'Aluminum Alloys':'Al','Titanium Alloys':'Ti','Precious Metals':'PM',
          'Refractory Metals':'RM','Cobalt-Chrome Alloys':'Co','Copper Alloys':'Cu',
          'Nickel Superalloys':'Ni','Tool Steel & Others':'TS','Stainless Steel':'SS',
          'Magnesium Alloys':'Mg'
        };

        // Initialize Chart.js
        const ctx = document.getElementById('materialChart').getContext('2d');
        Chart.register(ChartDataLabels);
        new Chart(ctx, {
          type: 'doughnut',
          data: { labels: categories, datasets: [{ data: dataValues, backgroundColor: colors, borderWidth:1 }] },
          options: {
            responsive:true,
            cutout:'50%',
            plugins:{
              legend:{ display:false },
              datalabels:{
                color:'#fff',
                font:{ family:'Poppins', weight:'700', size:14 },
                formatter:(value,ctx) => abbreviations[ctx.chart.data.labels[ctx.dataIndex]] || ''
              },
              tooltip:{
                backgroundColor:'rgba(33,33,33,0.85)',
                titleColor:'#ffffff',
                bodyColor:'#f1f1f1',
                titleFont:{ family:'Open Sans', weight:'700', size:14 },
                bodyFont:{ family:'Open Sans', size:12 },
                padding:8,
                cornerRadius:6,
                displayColors:false,
                bodySpacing:4,
                callbacks:{
                  title: items => items[0].label,
                  label: item => materialData[item.label]
                }
              }
            }
          }
        });

        // Render lists below chart with colored headings
        const listContainer = document.getElementById('materialLists');

        // Legend note for commercial availability
        const legendNote = document.createElement('p');
        legendNote.className = 'text-sm mb-2 italic';
        legendNote.textContent = 'Commercially available materials are highlighted in blue.';
        listContainer.parentNode.insertBefore(legendNote, listContainer);

        categories.forEach((cat, idx) => {
          const box = document.createElement('div');
          box.className = 'bg-white p-4 rounded shadow';

          const title = document.createElement('h2');
          title.textContent = cat;
          title.className = 'mb-2 p-2 rounded text-white';
          title.style.backgroundColor = colors[idx];
          box.appendChild(title);

          const ul = document.createElement('ul');
          ul.className = 'list-disc list-inside text-sm';

          materialData[cat].forEach(entry => {
            let name, isCommercial = false;
            if (typeof entry === 'object') {
              name = entry.name;
              isCommercial = entry.commercial;
            } else {
              name = entry;
            }
            const li = document.createElement('li');
            li.textContent = name;
            if (isCommercial) li.classList.add('text-blue-600','font-semibold');
            ul.appendChild(li);
          });
          box.appendChild(ul);

          listContainer.appendChild(box);
        });
      })
      .catch(err => console.error('Error loading materialData.json:', err));
  </script>
</body>
</html>
