<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LPBF Material Universe</title>
  <!-- TailwindCSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js"></script>
  <!-- Chart.js DataLabels Plugin -->
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
</head>
<body class="bg-gray-50">
  <div class="container mx-auto p-4">
    <h1 class="text-3xl font-bold text-center mb-8">LPBF Material Universe</h1>
    <!-- Chart Container -->
    <div class="max-w-md mx-auto">
      <canvas id="materialChart"></canvas>
    </div>
    <!-- Legend / Lists -->
    <div id="materialLists" class="mt-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6"></div>
  </div>

  <script>
    // Load material data from external JSON file
    fetch('materialData.json')
      .then(response => response.json())
      .then(materialData => {
        // Once data is loaded, initialize chart and lists
        const categories = Object.keys(materialData);
        const dataValues = categories.map(() => 1);
        const colors = ['#e63946','#f4a261','#e9c46a','#a8dadc','#2a9d8f','#b87333','#1d3557','#6a4c93','#9d4edd','#8ac926'];
        const abbreviations = {
          'Aluminum Alloys':'Al','Titanium Alloys':'Ti','Precious Metals':'PM',
          'Refractory Metals':'RM','Cobalt-Chrome Alloys':'Co','Copper Alloys':'Cu',
          'Nickel Superalloys':'Ni','Tool Steel & Others':'TS','Stainless Steel':'SS',
          'Magnesium Alloys':'Mg'
        };

        // Initialize Chart.js
        const ctx = document.getElementById('materialChart').getContext('2d');
        Chart.register(ChartDataLabels);
        new Chart(ctx, {
          type: 'doughnut',
          data: { labels: categories, datasets:[{ data: dataValues, backgroundColor: colors, borderWidth:1 }]},
          options: {
            responsive:true, cutout:'50%',
            plugins:{
              legend:{ display:false },
              datalabels:{ color:'#fff',font:{weight:'bold',size:14},formatter:(value,ctx)=> abbreviations[ctx.chart.data.labels[ctx.dataIndex]] || '' },
              tooltip:{ callbacks:{ title:items=>items[0].label, label:item=>materialData[item.label].join(', ') }}
            }
          }
        });

        // Render lists below chart
        const listContainer = document.getElementById('materialLists');
        categories.forEach(cat=>{
          const box = document.createElement('div'); box.className='bg-white p-4 rounded shadow';
          const title = document.createElement('h2'); title.className='font-semibold mb-2'; title.textContent=cat;
          box.appendChild(title);
          const ul = document.createElement('ul'); ul.className='list-disc list-inside text-sm';
          materialData[cat].forEach(item=>{ const li=document.createElement('li'); li.textContent=item; ul.appendChild(li); });
          box.appendChild(ul);
          listContainer.appendChild(box);
        });
      })
      .catch(err => console.error('Error loading materialData.json:', err));
  </script>
</body>
</html>
